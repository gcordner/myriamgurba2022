var mvnAlgoliaPrediction=function(){var a,b,c=[],d={initialize:function(){b=this,"undefined"!=typeof AlgoliaSearch&&this.initAlgolia()},initAlgolia:function(){a=algoliasearch(mvnAlgSettings.appId,mvnAlgSettings.apiKeySearch)},indexTaxonomies:function(){return!("undefined"==typeof mvnAlgSettings.indexTaxonomies||1!==parseInt(mvnAlgSettings.indexTaxonomies)||"undefined"==typeof mvnAlgSettings.taxonomiesToIndex||!mvnAlgSettings.taxonomiesToIndex)},searchCallback:function(a,e,f){var g=[],h=jQuery.inArray("posts",c);if(a&&e.results.length>0&&b.lastQuery===e.results[h].query){var i=e.results[h];if(i.hits.length>0)for(var j=0;j<i.hits.length;++j){var k=i.hits[j],l={label:k.title,value:k.title,title:k._highlightResult.title&&k._highlightResult.title.value||k.title,permalink:k.permalink,categories:k.category,tags:k._tags,excerpt:k._highlightResult.excerpt&&k._highlightResult.excerpt.value||k.excerpt,description:k._highlightResult.content&&k._highlightResult.content.value||k.content,date:k.date,featuredImage:k.featuredImage,category:mvnAlgSettings.labels.posts?mvnAlgSettings.labels.posts:""};g.push(l)}}a&&d.indexTaxonomies()&&jQuery.each(mvnAlgSettings.taxonomiesToIndex,function(a){if(h=jQuery.inArray(a,c),"undefined"!=typeof e.results&&"undefined"!=typeof e.results[h]){var b=e.results[h];if(b.hits.length>0)for(var d=0;d<b.hits.length;++d){var f=b.hits[d],i={label:f.title,value:f.objectID,title:f._highlightResult.title&&f._highlightResult.title.value||f.title,permalink:f.permalink,featuredImage:f.image,termId:f.termId,parent:f.parent,postsRelated:f.postsRelated,taxonomy:f.taxonomy,category:mvnAlgSettings.labels.taxonomies[a]?mvnAlgSettings.labels.taxonomies[a]:""};g.push(i)}}}),f(g)},getDisplayPost:function(a){var b="";if(b+='\t<a href="'+a.permalink+'" class="mvn-alg-item-link">',mvnAlgSettings.showThumbInPopup&&"undefined"!=typeof a.featuredImage&&a.featuredImage){var c=d.getThumbnailSrc(a.featuredImage,"thumbnail");if(c){var e=mvnAlgSettings.popupThumbnailArgs.w,f=mvnAlgSettings.popupThumbnailArgs.h;b+='\t\t<span class="mvn-alg-item-thumbnail"><img class="mvn-alg-item-thumbnail-img" src="'+c+'" width="'+e+'" height="'+f+'" /></span>'}}if(b+='\t\t<span class="mvn-alg-item-title">'+a.title.trim()+"</span>",mvnAlgSettings.showPostCategoriesInPopup&&"undefined"!=typeof a.categories&&(b+='\t\t<span class="mvn-alg-item-cats">'+a.categories.join()+"</span>"),mvnAlgSettings.showExcerptInPopup&&"undefined"!=typeof a.excerpt&&a.excerpt){var g=mvnAlgSettings.excerptMaxChars||0,h=a.excerpt;g>0&&(h=d.trimString(a.excerpt,g)),b+='\t\t<span class="mvn-alg-item-excerpt">'+h+"</span>"}return b+="\t</a>"},getDisplayTerm:function(a){var b="";if(b+='<a href="'+a.permalink+'" class="mvn-alg-cat-link">',mvnAlgSettings.showThumbInPopup&&"undefined"!=typeof a.featuredImage&&a.featuredImage){var c=d.getThumbnailSrc(a.featuredImage,"thumbnail");if(c){var e=mvnAlgSettings.popupThumbnailArgs.w,f=mvnAlgSettings.popupThumbnailArgs.h;htmlPost+='\t\t<span class="mvn-alg-cat-thumbnail"><img class="mvn-alg-cat-thumbnail-img" src="'+c+'" width="'+e+'" height="'+f+'" /></span>'}}return b+='\t\t<span class="mvn-alg-cat-title">'+a.title.trim()+"</span>",b+="</a>"},getThumbnailSrc:function(a,b){var c="";return a&&"undefined"!=typeof a.sizes&&"undefined"!=typeof a.sizes[b]&&a.sizes[b].file&&(c=a.sizes[b].file),c},trimString:function(a,b,c){if(c||(c="..."),a=a.trim(),a.length>b){a=a.substr(0,b);var d=a.lastIndexOf(" ");-1!==d&&(a=a.substr(0,Math.min(a.length,a.lastIndexOf(" ")))),a+=c}return a},search:function(e,f){"undefined"!=typeof a&&(c=[],a.startQueriesBatch(),a.addQueryInBatch(mvnAlgSettings.indexName,e.term,{attributesToRetrieve:["objectID","title","permalink","excerpt","content","date","featuredImage","category","_tags"],hitsPerPage:mvnAlgSearchVars.postsPerPage}),c.push("posts"),d.indexTaxonomies()&&jQuery.each(mvnAlgSettings.taxonomiesToIndex,function(b,d){"undefined"!=typeof d.indexName&&d.indexName&&(a.addQueryInBatch(d.indexName,e.term,{hitsPerPage:mvnAlgSearchVars.postsPerPage}),c.push(b))}),a.sendQueriesBatch(function(a,c){b.lastQuery=e.term,b.searchCallback(a,c,f)}))}};return d}(jQuery);jQuery(document).ready(function(a){mvnAlgoliaPrediction.initialize(),a("input[name='"+mvnAlgSearchVars.inputSearchName+"']").each(function(){a(this).autocomplete({minLength:1,source:mvnAlgoliaPrediction.search,select:function(b,c){return a(this).val(c.item.label),!1}}),a(this).autocomplete().data("ui-autocomplete")._renderItem=function(b,c){var d="";return"undefined"!=typeof c.taxonomy?(d=mvnAlgoliaPrediction.getDisplayTerm(c),a("<li class='mvn-alg-cat'></li>").data("item.autocomplete",c).append(d).appendTo(b)):(d=mvnAlgoliaPrediction.getDisplayPost(c),a("<li class='mvn-alg-item'></li>").data("item.autocomplete",c).append(d).appendTo(b))},"undefined"!=typeof mvnAlgSettings.indexTaxonomies&&mvnAlgSettings.indexTaxonomies>0&&"undefined"!=typeof mvnAlgSettings.taxonomiesToIndex&&(a(this).autocomplete().data("ui-autocomplete")._renderMenu=function(b,c){var d=this,e="";a.each(c,function(a,c){c.category&&c.category!==e&&(b.append("<li class='ui-autocomplete-category'><span>"+c.category+"</span></li>"),e=c.category),d._renderItemData(b,c)})})})});
{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./assets/jsx/gutenberg-panel.jsx"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","wp","config","registerPlugin","PluginDocumentSettingPanel","PanelRow","DateTimePicker","CheckboxControl","SelectControl","FormTokenField","Spinner","Fragment","Component","decodeEntities","isEmpty","keys","compact","window","postExpiratorPanelConfig","plugins","editPost","components","element","htmlEntities","lodash","render","arguments","state","categoriesList","catIdVsName","postMeta","this","attributes","data","select","getEditedPostAttribute","postType","getCurrentPostType","setPostMeta","newMeta","dispatch","meta","enabled","defaults","autoEnable","date","Date","expireAction","getExpireType","categories","includes","getCategories","browserTimezoneOffset","getTimezoneOffset","wpTimezoneOffset","timezone_offset","setTime","default_categories","default_date","parseInt","taxonomy","setState","getTime","apiFetch","path","url","addQueryArgs","per_page","then","list","forEach","cat","id","strings","category","context","taxAttributes","rest_base","terms","term","attribute","getDate","actionsList","label","draft","delete","trash","private","stick","unstick","_","union","categoryReplace","categoryAdd","categoryRemove","selectedCats","map","title","postExpirator","icon","initialOpen","className","enablePostExpiration","checked","onChange","currentDate","is_12_hours","howToExpire","options","loading","expirationCategories","suggestions","selectCategories","maxSuggestions","typeNew","typeOld","expireType","categoriesNew","categoriesOld","length","tokens","some","token","newDate","parse"],"mappings":"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","file":"gutenberg-panel.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","(function (wp, config) {\n\n    const {registerPlugin} = wp.plugins;\n    const {PluginDocumentSettingPanel} = wp.editPost;\n    const {PanelRow, DateTimePicker, CheckboxControl, SelectControl, FormTokenField, Spinner} = wp.components;\n    const {Fragment, Component} = wp.element;\n    const {decodeEntities} = wp.htmlEntities;\n    const {isEmpty, keys, compact} = lodash;\n\n    class PostExpiratorSidebar extends Component {\n        constructor() {\n            super(...arguments);\n\n            this.state = {\n                categoriesList: [],\n                catIdVsName: [],\n            }\n        }\n\n        componentWillMount() {\n            const {attributes} = this.state;\n\n            const postMeta = wp.data.select('core/editor').getEditedPostAttribute('meta');\n            const postType = wp.data.select('core/editor').getCurrentPostType();\n            const setPostMeta = (newMeta) => wp.data.dispatch('core/editor').editPost({meta: newMeta});\n\n            let enabled = config.defaults.autoEnable == 1;\n            let date = new Date();\n\n            let expireAction = this.getExpireType(postMeta);\n\n            let categories = [];\n            if (expireAction.includes('category')) {\n                categories = this.getCategories(postMeta);\n            }\n\n            if (postMeta['_expiration-date-status'] && postMeta['_expiration-date-status'] === 'saved') {\n                enabled = true;\n            }\n\n            let browserTimezoneOffset = date.getTimezoneOffset() * 60;\n            let wpTimezoneOffset = config.timezone_offset * 60;\n\n            if (postMeta['_expiration-date']) {\n                date.setTime((postMeta['_expiration-date'] + browserTimezoneOffset + wpTimezoneOffset) * 1000);\n            } else {\n                categories = config.default_categories;\n                if (config.default_date) {\n                    date.setTime((parseInt(config.default_date) + browserTimezoneOffset + wpTimezoneOffset) * 1000);\n                }\n            }\n\n            let taxonomy = config.defaults.taxonomy || 'category';\n\n            this.setState({\n                enabled: enabled,\n                date: date,\n                expireAction: expireAction,\n                categories: categories,\n                taxonomy: taxonomy,\n            });\n\n            // Force all the metadata to be saved. Required for making sure the default settings are stored correctly.\n            setPostMeta({'_expiration-date-status': (enabled ? 'saved' : '')});\n            setPostMeta({'_expiration-date': (date.getTime()) / 1000});\n            setPostMeta({'_expiration-date-type': expireAction});\n            setPostMeta({'_expiration-date-categories': categories});\n\n            let categoriesList = [];\n            let catIdVsName = [];\n\n            if ((!taxonomy && postType === 'post') || taxonomy === 'category') {\n                wp.apiFetch({\n                    path: wp.url.addQueryArgs('wp/v2/categories', {per_page: -1}),\n                }).then((list) => {\n                    list.forEach(cat => {\n                        categoriesList[cat.name] = cat;\n                        catIdVsName[cat.id] = cat.name;\n                    });\n                    this.setState({categoriesList: categoriesList, catIdVsName: catIdVsName, taxonomy: config.strings.category});\n                });\n            } else if (postType !== 'page') {\n                wp.apiFetch({\n                    path: wp.url.addQueryArgs(`wp/v2/taxonomies/${taxonomy}`, {context: 'edit'}),\n                }).then((taxAttributes) => {\n                    // fetch all terms\n                    wp.apiFetch({\n                        path: wp.url.addQueryArgs(`wp/v2/${taxAttributes.rest_base}`, {context: 'edit'}),\n                    }).then((terms) => {\n                        terms.forEach(term => {\n                            categoriesList[decodeEntities(term.name)] = term;\n                            catIdVsName[term.id] = decodeEntities(term.name);\n                        });\n                        this.setState({\n                            categoriesList: categoriesList,\n                            catIdVsName: catIdVsName,\n                            taxonomy: decodeEntities(taxAttributes.name)\n                        });\n                    });\n                });\n            }\n\n        }\n\n        componentDidUpdate() {\n            const {enabled, date, expireAction, categories, attribute} = this.state;\n            const setPostMeta = (newMeta) => wp.data.dispatch('core/editor').editPost({meta: newMeta});\n            const postMeta = wp.data.select('core/editor').getEditedPostAttribute('meta');\n\n            switch (attribute) {\n                case 'enabled':\n                    setPostMeta({'_expiration-date-status': (enabled ? 'saved' : '')});\n                    // if date is not set when the checkbox is enabled, set it to the default date\n                    // this is to prevent the user from having to click the date to set it\n                    if (!postMeta['_expiration-date']) {\n                        setPostMeta({'_expiration-date': this.getDate(date)});\n                    }\n                    break;\n                case 'date':\n                    if (typeof date === 'string') {\n                        setPostMeta({'_expiration-date': this.getDate(date)});\n                    }\n                    break;\n                case 'action':\n                    setPostMeta({'_expiration-date-type': expireAction});\n                    if (!expireAction.includes('category')) {\n                        setPostMeta({'_expiration-date-categories': []});\n                    }\n                    break;\n                case 'category':\n                    setPostMeta({'_expiration-date-categories': categories});\n                    break;\n            }\n\n        }\n\n        render() {\n            const {categoriesList, catIdVsName} = this.state;\n            const {enabled, date, expireAction, categories, taxonomy} = this.state;\n\n            const postType = wp.data.select('core/editor').getCurrentPostType();\n\n            let actionsList = [\n                {label: config.strings.draft, value: 'draft'},\n                {label: config.strings.delete, value: 'delete'},\n                {label: config.strings.trash, value: 'trash'},\n                {label: config.strings.private, value: 'private'},\n                {label: config.strings.stick, value: 'stick'},\n                {label: config.strings.unstick, value: 'unstick'},\n            ];\n\n            if (postType !== 'page') {\n                actionsList = _.union(actionsList, [\n                    {label: config.strings.categoryReplace, value: 'category'},\n                    {label: config.strings.categoryAdd, value: 'category-add'},\n                    {label: config.strings.categoryRemove, value: 'category-remove'},\n                ]);\n            }\n\n            let selectedCats = categories && compact(categories.map((id) => catIdVsName[id] || false));\n            if (typeof selectedCats === 'string') {\n                selectedCats = [];\n            }\n\n            return (\n                <PluginDocumentSettingPanel title={config.strings.postExpirator} icon=\"calendar\"\n                                            initialOpen={enabled} className={'post-expirator-panel'}>\n                    <PanelRow>\n                        <CheckboxControl\n                            label={config.strings.enablePostExpiration}\n                            checked={enabled}\n                            onChange={(value) => {\n                                this.setState({enabled: !enabled, attribute: 'enabled'})\n                            }}\n                        />\n                    </PanelRow>\n                    {enabled && (\n                        <Fragment>\n                            <PanelRow>\n                                <DateTimePicker\n                                    currentDate={date}\n                                    onChange={(value) => this.setState({date: value, attribute: 'date'})}\n                                    is_12_hours={config.is_12_hours}\n                                />\n                            </PanelRow>\n                            <SelectControl\n                                label={config.strings.howToExpire}\n                                value={expireAction}\n                                options={actionsList}\n                                onChange={(value) => {\n                                    this.setState({expireAction: value, attribute: 'action'})\n                                }}\n                            />\n                            {expireAction.includes('category') &&\n                            (\n                                (isEmpty(keys(categoriesList)) && (\n                                    <Fragment>\n                                        {config.strings.loading + ` (${taxonomy})`}\n                                        <Spinner/>\n                                    </Fragment>\n                                ))\n                                ||\n                                (\n                                    <FormTokenField\n                                        label={config.strings.expirationCategories + ` (${taxonomy})`}\n                                        value={selectedCats}\n                                        suggestions={Object.keys(categoriesList)}\n                                        onChange={(value) => {\n                                            this.setState({\n                                                categories: this.selectCategories(value),\n                                                attribute: 'category'\n                                            })\n                                        }}\n                                        maxSuggestions={10}\n                                    />\n                                )\n                            )}\n                        </Fragment>\n                    )}\n                </PluginDocumentSettingPanel>\n            );\n        }\n\n        // what action to take on expiration\n        getExpireType(postMeta) {\n            let typeNew = postMeta['_expiration-date-type'];\n            let typeOld = postMeta['_expiration-date-options'] && postMeta['_expiration-date-options']['expireType'];\n\n\n\n            if (typeNew) {\n                return typeNew;\n            }\n\n            if (typeOld) {\n                return typeOld;\n            }\n\n            if (config && config.defaults && config.defaults.expireType) {\n                return config.defaults.expireType;\n            }\n\n            return 'draft';\n        }\n\n        // what categories to add/remove/replace\n        getCategories(postMeta) {\n            let categoriesNew = postMeta['_expiration-date-categories'] && postMeta['_expiration-date-categories'];\n            let categoriesOld = postMeta['_expiration-date-options'] && postMeta['_expiration-date-options']['category'];\n\n            if (typeof categoriesNew === 'object' && categoriesNew.length > 0) {\n                return categoriesNew;\n            }\n\n            if (categoriesOld && typeof categoriesOld !== 'undefined' && typeof categoriesOld !== 'object') {\n                categories = [categoriesOld];\n            }\n\n            return categoriesOld;\n\n        }\n\n        // fired for the autocomplete\n        selectCategories(tokens) {\n            const {categoriesList, catIdVsName} = this.state;\n\n            var hasNoSuggestion = tokens.some(function (token) {\n                return typeof token === 'string' && !categoriesList[token];\n            });\n\n            if (hasNoSuggestion) {\n                return;\n            }\n\n            var categories = tokens.map(function (token) {\n                return typeof token === 'string' ? categoriesList[token] : token;\n            })\n\n            return categories.map((cat) => cat.id);\n        }\n\n        getDate(date) {\n            let newDate = new Date();\n            let browserTimezoneOffset = new Date().getTimezoneOffset() * 60;\n            let wpTimezoneOffset = config.timezone_offset * 60;\n            newDate.setTime(Date.parse(date));\n            newDate.setTime(newDate.getTime() - (browserTimezoneOffset + wpTimezoneOffset) * 1000);\n            return ((newDate.getTime()) / 1000);\n        }\n\n    }\n\n    registerPlugin('postexpirator-sidebar', {\n        render: PostExpiratorSidebar\n    });\n\n\n})(window.wp, window.postExpiratorPanelConfig);\n"],"sourceRoot":""}